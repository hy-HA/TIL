[1. íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”](#1-íŒ¨ìŠ¤ì›Œë“œ-ì•”í˜¸í™”)

[2. íšŒì›ê°€ì… ì¸ì¦ì²˜ë¦¬(ì´ë©”ì¼ í™œìš©)](#2-íšŒì›ê°€ì…-ì¸ì¦ì²˜ë¦¬ì´ë©”ì¼-í™œìš©)


# 1. ğŸ”‘ íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”

### 1. ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ê¶Œì¥ PasswordEncoder
- PasswordEncoderFactories.createDelegatingPasswordEncoder()
    - ì—¬ëŸ¬ í•´ì‹œ ì•Œê³ ë¦¬ë“¬ì„ ì§€ì›í•˜ëŠ” íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”
    - ê¸°ë³¸ ì•Œê³ ë¦¬ë“¬ bcrypt

### 2. í•´ì‹± ì•Œê³ ë¦¬ë“¬(bcrypt)ê³¼ ì†”íŠ¸(salt)

#### 1) í•´ì‹± ì•Œê³ ë¦¬ë“¬ì„ ì“°ëŠ” ì´ìœ ?
- 12345 ë¹„ë²ˆì„ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ë©´ í•´ì»¤ë“¤ì´ ì•„ì´ë””/ë¹„ë²ˆì„ ê°€ì§€ê³  íƒ€ì‚¬ì´íŠ¸ì— í™œìš©í•  ìˆ˜
- ì•Œê³ ë¦¬ì¦˜(bcrypt ë“±)ì„ ê°€ì§€ê³  '12345'ë¥¼ 'j6dfd6g57df66'í˜•íƒœë¡œ ë³€ê²½í•˜ëŠ” ê²ƒ

#### 2) ì†”íŠ¸ë¥¼ ì“°ëŠ” ì´ìœ ?
- 12345 + saltë¥¼ ì¶”ê°€í•˜ì—¬ ì „í˜€ ë‹¤ë¥¸ ê°’ì´ ë‚˜ì˜¤ë„ë¡ í•˜ëŠ” ê²ƒ
- bcrypt ê²½ìš°
    - ì†”íŠ¸ë¥¼ í•´ì‹±ì„ í• ë•Œë§ˆë‹¤ ëœë¤í•œ ê°’ì„ ì¨ë„ ë¬´ë°©.


## 1. íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë” ì„¤ì •í•˜ê¸°
```
@Configuration
public class AppConfig {

    @Bean
    public PasswordEncoder passwordEncoder() {
        return PasswordEncoderFactories.createDelegatingPasswordEncoder();
    }
}
```
### ì°¸ê³ . PasswordEncoderFactories
1. ê¸°ë³¸ ì•Œê³ ë¦¬ë“¬ bcryptì¸ ê²ƒ í™•ì¸
    - BCryptPasswordEncoder()
    ```
    public final class PasswordEncoderFactories {
        private PasswordEncoderFactories() {
        }

        public static PasswordEncoder createDelegatingPasswordEncoder() {
            String encodingId = "bcrypt";
            Map<String, PasswordEncoder> encoders = new HashMap();
            encoders.put(encodingId, new BCryptPasswordEncoder());
            encoders.put("ldap", new LdapShaPasswordEncoder());
            encoders.put("MD4", new Md4PasswordEncoder());
            encoders.put("MD5", new MessageDigestPasswordEncoder("MD5"));
            encoders.put("noop", NoOpPasswordEncoder.getInstance());
            encoders.put("pbkdf2", new Pbkdf2PasswordEncoder());
            encoders.put("scrypt", new SCryptPasswordEncoder());
            encoders.put("SHA-1", new MessageDigestPasswordEncoder("SHA-1"));
            encoders.put("SHA-256", new MessageDigestPasswordEncoder("SHA-256"));
            encoders.put("sha256", new StandardPasswordEncoder());
            encoders.put("argon2", new Argon2PasswordEncoder());
            return new DelegatingPasswordEncoder(encodingId, encoders);
        }
    }
    ```
2. PasswordEncoderFactories ë‚´ë¶€ì˜ BCryptPasswordEncoder ë©”ì†Œë“œì—ì„œ ì¸ì½”ë”©í•˜ëŠ” ì½”ë“œ í™•ì¸ ê°€ëŠ¥
    - encodeë©”ì†Œë“œì—ì„œ íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”©ì„ í•˜ê²Œ ë¨
    ```
    public class BCryptPasswordEncoder implements PasswordEncoder {

        // íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”© í•˜ëŠ” ë¶€ë¶„
        public String encode(CharSequence rawPassword) {
            if (rawPassword == null) {
                throw new IllegalArgumentException("rawPassword cannot be null");
            } else {
                String salt = this.getSalt();
                return BCrypt.hashpw(rawPassword.toString(), salt);
            }
        }
    }
    ```

# 2. íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”ë¥¼ í™œìš©í•˜ì—¬ íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”©

```
@Slf4j @Service
@Transactional @RequiredArgsConstructor
public class AccountService implements UserDetailsService {

    private final ModelMapper modelMapper;
    private final PasswordEncoder passwordEncoder;
    
    private Account saveNewAccount(@Valid SignUpForm signUpForm) {
        signUpForm.setPassword(passwordEncoder.encode(signUpForm.getPassword()));
        Account account = modelMapper.map(signUpForm, Account.class);
        account.generateEmailCheckToken();
        return accountRepository.save(account);
    }
}
```
- ì°¸ê³  - Accountì˜ generateEmailCheckToken()
```
public class Account {
    public void generateEmailCheckToken() {
        this.emailCheckToken = UUID.randomUUID().toString();
        this.emailCheckTokenGeneratedAt = LocalDateTime.now();
    }
}
```

# 2. ğŸ“© íšŒì›ê°€ì… ì¸ì¦ì²˜ë¦¬(ì´ë©”ì¼ í™œìš©)
### ëª©ì 
- ë¬´ì‘ìœ„ ì—‰í„°ë¦¬ ì´ë©”ì¼ë¡œ ê°€ì…í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨
- ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©ì¤‘ì¸ ì§„ì§œ ìœ ì €ìˆ˜ë¥¼ í™•ë³´í•˜ê¸° ìœ„í•¨
### ì¥ì 
- í¼ ê¸°ë°˜ì˜ ë…ìì ì¸ íšŒì›ê´€ë¦¬
    - ìì²´ì ìœ¼ë¡œ ì´ë©”ì¼ ê²€ì¦í•˜ëŠ” ì‘ì—…ì„ í•¨
### ì„œë¹„ìŠ¤ íë¦„
1. ìœ ì €ê°€ íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ë©´, ì´ë©”ì¼ë¡œ ë§í¬ê°€ ë°œì†¡.
2. ìœ ì €ê°€ ì´ë©”ì¼ì—ì„œ ë§í¬ë¥¼ í´ë¦­í•˜ë©´ ì‚¬ì´íŠ¸ë¡œ ìš”ì²­ì´ ê°.
3. ì„œë²„ì—ì„œ í† í°ê³¼ ì´ë©”ì¼ ê°’ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬.
    1. ì´ë©”ì¼ì´ ì •í™•í•˜ì§€ ì•Šì€ ê²½ìš° ì—ëŸ¬ì²˜ë¦¬
    2. í† í°ì´ ì •í™•í•˜ì§€ ì•Šì€ ê²½ìš° ì—ëŸ¬ì²˜ë¦¬
    3. ì´ë©”ì¼ê³¼ í† í°ì´ ì •í™•í•œ ê²½ìš° ê°€ì… ì™„ë£Œ ì²˜ë¦¬
        1. ê°€ì… ì¼ì‹œ ì„¤ì •
        2. ì´ë©”ì¼ ì¸ì¦ì—¬ë¶€ trueë¡œ ì„¤ì •
### ê°œë…
1. ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ì„ ìœ„í•œ MailSender ì¸í„°í˜ì´ìŠ¤ ì œê³µ
- SimpleMailMessage(ë©”ì¼ ì œëª©, ë‹¨ìˆœ í…ìŠ¤íŠ¸ ë‚´ìš©)ë¥¼ ì „ë‹¬ë°›ì•„ ë©”ì¼ì„ ë°œì†¡í•˜ëŠ” ê¸°ëŠ¥ì„ ì •ì˜
2. JavaMailSender
- MailSender ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ì€ JavaMailSender
- Java Mail APIì˜ MimeMessageë¥¼ ì´ìš©í•´ì„œ ë©”ì¼ì„ ë°œì†¡í•˜ëŠ” ì¶”ê°€ì ì¸ ê¸°ëŠ¥ ì •ì˜

## [1. ì´ë©”ì¼ ê´€ë ¨ ì„¤ì •](#1-ë©”ì¼-ê´€ë ¨-ì„¤ì •)
- í•˜ë‹¨ì—ì„œ ë‹¤ì‹œ ì„¤ëª…

## 2.ìœ ì €ê°€ íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ë©´, ì´ë©”ì¼ë¡œ ë§í¬ê°€ ë°œì†¡
1. íšŒì› ì •ë³´ ì €ì¥
2. ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
3. ì²˜ë¦¬ í›„ ì²« í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (Post-Redirect-Get íŒ¨í„´)

### AccountController

```
public class AccountController {

    @PostMapping("/sign-up")   
    public String signUpSubmit(@Valid SignUpForm signUpForm, Errors errors) {

        //ì—ëŸ¬ ë°œìƒí•˜ë©´ í¼ ë‹¤ì‹œ ë³´ì—¬ì£¼ê¸°
        if (errors.hasErrors()) {
            return "account/sign-up";
        }

        accountService.processNewAccount(signUpForm); //(1)íšŒì› ì •ë³´ ì €ì¥+ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
        return "redirect:/"; //(2)ì²˜ë¦¬ í›„ ì²« í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (Post-Redirect-Get íŒ¨í„´)
    }
}
```
### accountService.processNewAccount(signUpForm)
```
public class AccountService {

    private final AccountRepository accountRepository;
    private final JavaMailSender javaMailSender;

    //(1)íšŒì› ì •ë³´ ì €ì¥+ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
    public void processNewAccount(SignUpForm signUpForm) { 
        Account newAccount = saveNewAccount(signUpForm); //(2)íšŒì› ì •ë³´ ì €ì¥
        newAccount.generateEmailCheckToken();            //(3)ì´ë©”ì¼ í† í° ìƒì„±
        sendSignUpConfirmEmail(newAccount);              //(4)ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
    }

    //(2)íšŒì› ì •ë³´ ì €ì¥
    private Account saveNewAccount(@Valid SignUpForm signUpForm) {
        Account account = Account.builder()
                .email(signUpForm.getEmail())
                .nickname(signUpForm.getNickname())
                .password(signUpForm.getPassword()) // TODO encoding í•´ì•¼í•¨
                .studyCreatedByWeb(true)
                .studyEnrollmentResultByWeb(true)
                .studyUpdatedByWeb(true)
                .build();
        return accountRepository.save(account);
    }

    //(4)ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
    private void sendSignUpConfirmEmail(Account newAccount) {

        //(1)ê°ì²´ ìƒì„±
        SimpleMailMessage mailMessage = new SimpleMailMessage();
        //(2)ë°œì‹ ì¸
        mailMessage.setTo(newAccount.getEmail());
        //(3)ì œëª©
        mailMessage.setSubject("ìŠ¤í„°ë””ì˜¬ë˜, íšŒì› ê°€ì… ì¸ì¦");
        //(4)ë³¸ë¬¸
        mailMessage.setText("/check-email-token?token=" + newAccount.getEmailCheckToken() +
                "&email=" + newAccount.getEmail());
        //(5)ë©”ì¼ ë°œì†¡
        javaMailSender.send(mailMessage);
    }

}

```
### newAccount.generateEmailCheckToken()
- ê³„ì •ì—ì„œ ëœë¤ í† í°ê°’ ìƒì„±(UUID ì‚¬ìš©
```
public void generateEmailCheckToken() {
    this.emailCheckToken = UUID.randomUUID().toString();
}
```



## 3. ìœ ì €ê°€ ë§í¬ í´ë¦­ í›„ ì„œë²„ëŠ” í† í°ê³¼ ì´ë©”ì¼ ê°’ì— ëŒ€í•œ ìš”ì²­ ì²˜ë¦¬
1. ë™ì¼í•œ ì´ë©”ì¼ì„ ê°€ì§„ ìœ ì €ê°€ ìˆëŠ”ì§€ í™•ì¸
2. ë°›ì€ í† í°ê³¼ ê³„ì •ì˜ í† í°ì´ ë™ì¼í•œì§€ ë¹„êµ
3. ì´ë©”ì¼ ì¸ì¦ì—¬ë¶€ trueë¡œ ì„¤ì • + ê°€ì…ë‚ ì§œ ì„¤ì •
4. ë·°ì— ë‹‰ë„¤ì„ê³¼ ëª‡ë²ˆì§¸ íšŒì›ì¸ì§€ ëª¨ë¸ì— ê°’ ì €ì¥

### ì»¨íŠ¸ë¡¤ëŸ¬
```
@Controller
@RequiredArgsConstructor
public class AccountController {

    private final AccountRepository accountRepository;

    @GetMapping("/check-email-token")
    public String checkEmailToken(String token, String email, Model model) {
        Account account = accountRepository.findByEmail(email);   //(1)ë™ì¼í•œ ì´ë©”ì¼ì„ ê°€ì§„ ìœ ì € í™•ì¸
        String view = "account/checked-email";
        if (account == null) {
            model.addAttribute("error", "wrong.email");
            return view;
        }

        if (!account.isValidToken(token)) { //(2)ë°›ì€ í† í°ê³¼ ê³„ì •ì˜ í† í°ì´ ë™ì¼í•œì§€ ë¹„êµ
            model.addAttribute("error", "wrong.token");
            return view;
        }

        accountService.completeSignUp(account); //(3)ì´ë©”ì¼ ì¸ì¦ì—¬ë¶€ trueë¡œ ì„¤ì • + ê°€ì…ë‚ ì§œ ì„¤ì •
        model.addAttribute("numberOfUser", accountRepository.count());
        model.addAttribute("nickname", account.getNickname());
        return view;
    }
```
### account.isValidToken(String token)
```
public boolean isValidToken(String token) {
    return this.emailCheckToken.equals(token);
}
```
### accountService.completeSignUp(Account account)
```
public void completeSignUp(Account account) {
        account.completeSignUp();
        login(account);
    }
```
### account.completeSignUp()
```
public void completeSignUp() {
    this.emailVerified = true;
    this.joinedAt = LocalDateTime.now();
}
```

## 1. ë©”ì¼ ê´€ë ¨ ì„¤ì •
### 1. 'spring email ëª¨ë“ˆ' ì˜ì¡´ì„± ì„¤ì •
- emailê³¼ ê´€ë ¨ëœ ê¸°ë³¸ ì„¤ì •ë“¤ ì ìš©ì´ ë¨
    - MailSenderAutoConfigurationì— ì •ì˜ê°€ ë˜ì–´ìˆìŒ
```
pom.xml>>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-mail</artifactId>
</dependency>
```
### 2. ConsoleMailSender ìƒì„±
- ê°€ì§œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ì½˜ì†”ì— ì¶œë ¥í•˜ëŠ” ConsoleMailSender ìƒì„± í›„ ì˜¤ë²„ë¼ì´ë”©
    - ë‚˜ì¤‘ì— ì§„ì§œ ê°ì²´ë¡œ ë°”ê¿€ ì˜ˆì •
- Profileì´ ë¡œì»¬ì¼ ë•Œ ì‚¬ìš©ì˜ˆì •
- ì¶”í›„ ì‚­ì œë  ì˜ˆì •
```
@Profil("local")
@Component
public class ConsoleMailSender implements JavaMailSender {

    @Override
    public void send(SimpleMailMessage simpleMailMessage) throws MailException {

        log.info(simpleMailMessage.getText()); //ì½˜ì†”ì°½ì— ì„¤ì •í•œ ë©”ì„¸ì§€ ì¶œë ¥
    }
}
```

### 3. SMTP ì„¤ì •
- êµ¬ê¸€ Gmailì„ SMTP ì„œë²„ë¡œ ì‚¬ìš©í•˜ì—¬ ì´ë©”ì¼ ë³´ë‚´ê¸°
- ì¼ì¼ ì‚¬ìš©ëŸ‰ì´ í•œì •ë˜ì–´ìˆì–´ ì‹¤ì œ ìš´ì˜ì‹œì—ëŠ” ì í•©í•˜ì§€ ì•ŠìŒ
#### App íŒ¨ìŠ¤ì›Œë“œ ë°œê¸‰
- 2-step verification í™œì„±í™”
- ì•± íŒ¨ìŠ¤ì›Œë“œ ë°œê¸‰
    - select appì€ ê¸°íƒ€ ë“±ë“±(SMTP)ìœ¼ë¡œ ì„¤ì •

#### application-dev.properties ì„¤ì •
- ì´ë©”ì¼ì„ ì „ì†¡í•  ë•Œ ì•„ë˜ ê°’ì„ ì“°ê²Œ ë¨
```
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=studyolledev@gmail.com // ë³¸ì¸ gmail ê³„ì •ìœ¼ë¡œ ë°”ê¾¸ì„¸ìš”.
spring.mail.password=jsxtgzwirzbvctix // ìœ„ì—ì„œ ë°œê¸‰ë°›ì€ App íŒ¨ìŠ¤ì›Œë“œë¡œ ë°”ê¾¸ì„¸ìš”.
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.starttls.enable=true
```

#### ëŒ€ì²´ ì„œë¹„ìŠ¤
- https://sendgrid.com/
- https://www.mailgun.com/
- https://aws.amazon.com/ses/
- https://gsuite.google.com/


### 4. EmailService ì¶”ìƒí™”
- ê°œë°œí™˜ê²½(HTMLë¡œ ë°œì†¡)ê³¼ ë¡œì»¬í™˜ê²½(ì½˜ì†”ë¡œ ì¶œë ¥)ì¼ ë•Œ ë‹¤ë¥´ê²Œ ì ìš©ë  ìˆ˜ ìˆë„ë¡ ì„¤ì •
1. HTML ì´ë©”ì¼ ì „ì†¡í•˜ê¸°
- MimeMessage ì „ì†¡
    - í˜„ì¬ ì½˜ì†”ë¡œ ë³´ë‚´ëŠ” SimpleMailMessageê°€ ì•„ë‹Œ HTMLë¡œ ë³´ë‚¼ ìˆ˜ ìˆê²Œ MimeMessage ì‚¬ìš©
- MimeMessageHelper: MimeMessage ë§Œë“¤ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ í‹¸ë¦¬í‹°

2. EmailService ì¸í„°í˜ì´ìŠ¤
- void sendEmail(EmailMessage emailMessage);

3. EmailService ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì²´
- ConsoleEmailService: ì½˜ì†” ì¶œë ¥
- HtmlEmailService: JavaMailSenderë¥¼ ì‚¬ìš©í•´ì„œ HTMLë¡œ ì´ë©”ì¼ ì „ì†¡

### AccountService
```
    public Account processNewAccount(SignUpForm signUpForm) {
        Account newAccount = saveNewAccount(signUpForm);
        sendSignUpConfirmEmail(newAccount);
        return newAccount;
    }

    private Account saveNewAccount(@Valid SignUpForm signUpForm) {
        signUpForm.setPassword(passwordEncoder.encode(signUpForm.getPassword()));
        Account account = modelMapper.map(signUpForm, Account.class);
        account.generateEmailCheckToken();
        return accountRepository.save(account);
    }

    public void sendSignUpConfirmEmail(Account newAccount) {
        EmailMessage emailMessage = EmailMessage.builder()
                .to(newAccount.getEmail())
                .subject("ìŠ¤í„°ë””ì˜¬ë˜, íšŒì› ê°€ì… ì¸ì¦")
                .message("/check-email-token?token=" + newAccount.getEmailCheckToken() + "&email=" + newAccount.getEmail())
                .build();

        emailService.sendEmail(emailMessage);
    }
```

### EmailService ì¸í„°í˜ì´ìŠ¤
- emailMaessageë¥¼ ë°›ì•„ ì´ë©”ì¼ì„ ì „ì†¡í•˜ëŠ” ë©”ì†Œë“œ
```
public interface EmailService {
    void sendEmail(EmailMessage emailMessage); 
}
```

### EmailMessage
```
@Data
@Builder
public class EmailMessage {

    private String to; //ìˆ˜ì‹ ì¸

    private String subject; //ì œëª©

    private String message; //ë‚´ìš©

}
```
### ì´ë©”ì¼ ë³´ë‚´ì£¼ëŠ” êµ¬í˜„ì²´1_ConsoleEmailService
- ë¡œì»¬í™˜ê²½ì—ì„œ ì‚¬ìš©
    - @Profile("local")
- ë©”ì„¸ì§€ê°€ ì–´ë–¤ ë‚´ìš©ìœ¼ë¡œ ë³´ë‚´ì¡ŒëŠ”ì§€ ë¡œê¹…ë§Œ í•  ê²ƒ
```
@Slf4j
@Profile("local")
@Component
public class ConsoleEmailService implements EmailService{

    @Override
    public void sendEmail(EmailMessage emailMessage) {
        log.info("sent email: {}", emailMessage.getMessage());
    }
}
```

### ì´ë©”ì¼ ë³´ë‚´ì£¼ëŠ” êµ¬í˜„ì²´2_HtmlEmailService
- @Profile("dev")ì¼ ë•Œ ì‚¬ìš©
- MimeMessage ì „ì†¡
    - í˜„ì¬ ì½˜ì†”ë¡œ ë³´ë‚´ëŠ” SimpleMailMessageê°€ ì•„ë‹Œ HTMLë¡œ ë³´ë‚¼ ìˆ˜ ìˆê²Œ MimeMessage ì‚¬ìš©
- MimeMessageHelper: MimeMessage ë§Œë“¤ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ í‹¸ë¦¬í‹°
```
@Slf4j
@Profile("dev")
@Component
@RequiredArgsConstructor
public class HtmlEmailService implements EmailService {

    private final JavaMailSender javaMailSender;

    @Override
    public void sendEmail(EmailMessage emailMessage) {
        MimeMessage mimeMessage = javaMailSender.createMimeMessage();
        try {
            MimeMessageHelper mimeMessageHelper = new MimeMessageHelper(mimeMessage, false, "UTF-8");
            mimeMessageHelper.setTo(emailMessage.getTo());
            mimeMessageHelper.setSubject(emailMessage.getSubject());
            mimeMessageHelper.setText(emailMessage.getMessage(), false);
            javaMailSender.send(mimeMessage);

            log.info("sent email: {}", emailMessage.getMessage());
        
        } catch (MessagingException e) {
            log.error("failed to send email", e);
        }
    }
}
```