# í•™ìƒ ìƒì„±í•˜ê¸°
- [ì–´ë…¸í…Œì´ì…˜ ì°¸ì¡°](https://hackmd.io/_jk5q_29RduLoBBsuHH48A)
- validation
    1. ì»¤ìŠ¤í…€ ìµì…ˆì…˜ í´ë˜ìŠ¤ ìƒì„±
    2. request ê°ì²´ì—ì„œ @NotNull ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê²€ì‚¬
    3. ì„œë¹„ìŠ¤ì—ì„œ ì˜ˆì™¸ì²˜ë¦¬

# ì»¨íŠ¸ë¡¤ëŸ¬ ğŸŸ¨
1. request ë°ì´í„°ë¥¼ @RequestBodyë¡œ ë°›ì•„ì„œ 
2. studentê°ì²´ CREATE í›„
3. @ResponseBodyë¡œ ë°˜í™˜


```java
@RestController
@RequiredArgsConstructor
public class SubjectController {
    
    private final SubjectService subjectService;
    
    @ResponseBody
    @PostMapping("/subject")
    public ResponseEntity<SubjectResponse> createSubject(@RequestBody SubjectForm request){
        SubjectResponse subjectResponse = subjectService.createSubject(request);
        return ResponseEntity.ok(subjectResponse);
    }
}
```
### í´ë˜ìŠ¤ ì–´ë…¸í…Œì´ì…˜
- @RestController ğŸŸ¨ | @RequiredArgsConstructor

### ë©”ì†Œë“œ ì–´ë…¸í…Œì´ì…˜
- @ResponseBody ğŸŸ¨ | @PostMapping("/subject")
### íŒŒë¼ë¯¸í„° ì–´ë…¸í…Œì´ì…˜
- @RequestBody
### ë°˜í™˜ê°ì²´ ResponseEntity
- ResponseEntityë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ  ğŸŸ¨
    - `ResponseEntity.status(HttpStatus.NO_CONTENT).build()`
    - `ResponseEntity.ok(subjectResponse)`


# ë„ë©”ì¸
1. DBí…Œì´ë¸”ì— ë§¤ì¹­í•  `ì—”í‹°í‹°` ìƒì„±
    - `primary key` ì§€ì •
    - í•„ìš”í•œ í•„ë“œ ì„ ì–¸
2. ì„œë¹„ìŠ¤ ë‹¨ê³„ì—ì„œ ê°€ì ¸ë‹¤ ì“¸ `ìƒì„±ì` ë§Œë“¤ì–´ë‘ê¸° 
### í´ë˜ìŠ¤ ì–´ë…¸í…Œì´ì…˜
- @Getter | @NoArgsConstructor | @Entity | @Table(name="student")
### Primary Key
- entityëŠ” primaryí‚¤ê°€ í•„ìˆ˜ë¡œ í•„ìš”
### ìƒì„±ì ì„ ì–¸
- request ë°ì´í„°ë¥¼ @RequestBodyë¡œ ë°›ì•„ì„œ studentê°ì²´ ìƒì„±í›„ ë°˜í™˜
    - ì»¨íŠ¸ë¡¤ëŸ¬ ë‹¨ê³„ ì°¸ê³ 
```java
@Getter
@NoArgsConstructor
@Entity
@Table(name="student")
public class Student {
    
    //entityëŠ” primaryí‚¤ê°€ í•„ìˆ˜ë¡œ í•„ìš”
    @Id @GeneratedValue
    private Long id;

    private String studentName;

    //requestê°ì²´ì—ì„œ Stringí•„ë“œë¥¼ ë°›ì•„ì„œ studentê°ì²´ ìƒì„±í›„ ë°˜í™˜
    @Builder
    public Student(String name){
        this.studentName = name;
    }
}
```
# DTO
## Request ê°ì²´
1. í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´
2. validation ê²€ì‚¬ â›‘

### í´ë˜ìŠ¤ ì–´ë…¸í…Œì´ì…˜
- @Data | @AllArgsConstructor | @NoArgsConstructor
### validation â›‘
- @NotNull   
```java
@Data
@AllArgsConstructor
@NoArgsConstructor
public class StudentForm {

    //validation
    @NotNull
    private String studentName;
}
```
## Response ê°ì²´
1. Entityê°ì²´ë¥¼ response ê°ì²´ë¡œ ë°˜í™˜
    1. ìƒì„±ì í•„ìš” ğŸ§©
    2. primary í•„ë“œ í•„ìš” ğŸ§©
### í´ë˜ìŠ¤ ì–´ë…¸í…Œì´ì…˜ 
- ìƒë™
### Primary Key í•„ë“œ ğŸ§©
- Entityê°ì²´ë¥¼ ë°›ì•„ ë°˜í™˜í•˜ë¯€ë¡œ request ê°ì²´ì™€ ë‹¤ë¥´ê²Œ idí•„ë“œê°€ í•„ìš”
### ë°˜í™˜ê°ì²´ ìƒì„±ì ğŸ§©
- Entityê°ì²´ë¥¼ ë°›ì•„ì„œ Response ê°ì²´ë¡œ ë³€í™˜


```java
@Data
@AllArgsConstructor
@NoArgsConstructor
public class StudentResponse {

    private Long id;
    private String studentName;

    public StudentResponse(Student request) {
        this.id = request.getId();
        this.studentName = request.getStudentName();
    }
}
```
# ë¦¬í¬ì§€í† ë¦¬
- JAPë¦¬í¬ì§€í† ë¦¬ëŠ” ì œë„¤ë¦­í´ë˜ìŠ¤
    - íŒŒë¼ë¯¸í„°ë¡œ ê°ì²´ íƒ€ì… ì§€ì •í•´ì¤˜ì•¼ ì˜¤ë¥˜ê°€ ë‚˜ì§€ ì•ŠëŠ”ë‹¤ ğŸ§©
```java
public interface StudentRepository extends JpaRepository<Student,Long> {}
```

# ì„œë¹„ìŠ¤
1. Requestê°ì²´ë¥¼ ì „ë‹¬ë°›ì•„ì„œ(StudentForm)
2. Requestê°ì²´ ì˜ˆì™¸ì²˜ë¦¬ í•´ì£¼ê³  `â›‘(validation)`
3. í•™ìƒê°ì²´ë¥¼ ë§Œë“¤ì–´ì£¼ê³ (Student)
    - builder ì‚¬ìš©
    - ì´ë•Œ idëŠ” ìë™ ìƒì„±ë¨(@Id, @GeneratedValue)
4. ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥í•˜ê³ (ì €ì¥íƒ€ì…ì€ Student)
    - ë¦¬í¬ì§€í† ë¦¬ëŠ” ì œë„¤ë¦­ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ê³  ìˆìœ¼ë¯€ë¡œ 
    - ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì„ ì–¸í•œ íƒ€ì…ìœ¼ë¡œ ì „ë‹¬í•´ì£¼ì–´ì•¼í•¨
5. responseê°ì²´ë¡œ ë³€í™˜í•´ì„œ ì „ë‹¬(StudentResponse)

```java
@Service
@RequiredArgsConstructor
public class StudentService {
    private final StudentRepository studentRepository;

    @Transactional
    public StudentResponse createStudent(StudentForm request) {

        //validation â›‘
        if(request.getStudentName() == null){
            throw new NullException(request.getName());
        }
        //í•™ìƒ ê°ì²´ ìƒì„±í•´ì„œ requestì—ì„œ ë°›ì€ ë‚´ìš© ë³€í™˜í•´ì£¼ê¸°
        Student student = Student.builder()
                .name(request.getStudentName())
                .build();
        //í•™ìƒ ê°ì²´ë¥¼ ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥(ë¦¬í¬ì§€í† ë¦¬ëŠ” í•™ìƒê°ì²´ë¡œ ë°›ê¸° ë•Œë¬¸)
        studentRepository.save(student);

        //ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥í•œ í•™ìƒê°ì²´ë¥¼ responseê°ì²´ë¡œ ë‹´ì•„ì„œ ë°˜í™˜
        return new StudentResponse(student);
    }
```

# ì»¤ìŠ¤í…€ ìµì…‰ì…˜ â›‘
- `(validation)`
```java
@ResponseStatus(code = HttpStatus.INTERNAL_SERVER_ERROR, reason = "nullê°’ì€ í—ˆìš©í•˜ì§€ ì•ŠìŒ")
public class NullException extends RuntimeException {

    public NullException(String message) {
        super(message);
    }

    public static NullException notNull() {
        return new NullException("ê³µë°±ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
    }
}

```


