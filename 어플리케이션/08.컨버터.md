# 컨버터
## Convert
- db에서 조회시 암호화 되고
- 앱에서 조회시 복호화 될 수 있도록

## AttributeConverter
- AttributeConverter는 주로 다음과 같은 상황에서 사용된다.
    1. JPA가 지원하지 않는 타입을 매핑
    2. 두 개 이상의 속성을 갖는 밸류 타입을 한 개 칼럼에 매핑

### 메소드
1. convertToDatabaseColumn() 
    - 테이블에 저장 혹은 변경이 있을 때 호출이 되는 메소드
2. convertToEntityAttribute() 
    - 테이블에서 출력이 될때 호출이 되는 메소드

## 사용법
1. 값 객체로 만들 "필드"에 @Convert 선언해주기
    ```
    public class Grade {

        @Convert(converter = Score.ScoreConverter.class)
        private Score score;

        //..
    }
    ```
2. 컨버터에 AttributeConverter를 implements하기
    ```
    public class Score {

        private final int value;

        public Score(int value) {
            if (value < 0 || value > 100) {
                throw new IllegalArgumentException("존재 할 수 없는 점수입니다.");
            }

            this.value = value;
        }

        public Integer getValue() {
            return value;
        }

        public String toString() {
            return String.format("%s점", value);
        }

        public static class ScoreConverter implements AttributeConverter<Score, Integer> {

            @Override
            public Integer convertToDatabaseColumn(Score attribute) {

                // Score -> int 타입으로 돌려주기
                return attribute.getValue();
            }

            @Override
            public Score convertToEntityAttribute(Integer dbData) {

                // Integer -> Score 타입으로 돌려주기
                return new Score(dbData);
            }
        }
    }
    ```
3. 해당 값을 초기화하는 생성 단계 정비
    1. 기존 setter값 정비
    2. Integer로 변환하는 메서드 생성
```
    public static Grade of(Student student, Subject subject, int score){

        Grade grade = new Grade();
        grade.student= student;
        grade.subject = subject;
        //grade.score = score;
        grade.score = new Score(score);
        return grade;
    }

    @Builder
    public Grade(int score){
        //this.score = score;
        this.score = new Score(score);
    }

    public void student(Student student) {
        this.student = student;
    }

    public void subject(Subject subject) {
        this.subject = subject;
    }

    public String getSubjectType() {
        return this.subject.getSubjectType();
    }

    public void updateScore(int score) {
        //this.score = score;
        this.score = new Score(score);
    }

    //Integer로 변환하는 메서드 생성
    public Integer getScore() {
        return score.getValue();
    }
```


## DDD
1. 값 객체
    - id를 갖고 있지 않음
2. 엔티티 객체
    - id를 가지고 있음
