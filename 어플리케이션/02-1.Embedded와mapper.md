| ì˜ ì„¤ê³„í•œ ORMì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ë§¤í•‘í•œ í…Œì´ë¸”ì˜ ìˆ˜ê°€ í´ë˜ìŠ¤ì˜ ìˆ˜ë³´ë‹¤ ë” ë§ë‹¤

| 01.JPAê¸°ë³¸ > JPAë°ì´í„°íƒ€ì… ì°¸ê³  
# Embedded íƒ€ì…
- ì°¸ê³  : JPA > ê°’íƒ€ì… - ë³µí•©ê°’ íƒ€ì… ì°¸ê³ 
- í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œ ì„ë² ë””ë“œ íƒ€ì…ì„ ì»´í¬ë„ŒíŠ¸ íƒ€ì…ì´ë¼ í•¨ âš ï¸

### ì´ìœ 
- ì½”ë“œì˜ ì¬ì‚¬ìš©
- ë†’ì€ ì‘ì§‘ë„
- Period.isWork()ì²˜ëŸ¼ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ ìˆëŠ” ë©”ì†Œë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ ğŸ§©

### íŠ¹ì§•
- ì„ë² ë””ë“œ íƒ€ì…ì„ í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€, ê°’ íƒ€ì…ì„ ì†Œìœ í•œ ì—”í‹°í‹°ì— ìƒëª…ì£¼ê¸°ë¥¼ ì˜ì¡´í•¨ ğŸ§©

### ì‚¬ìš©ë²•
- ê¸°ë³¸ ìƒì„±ìê°€ í•„ìˆ˜
- @Embedded
    - ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ
- @Embeddable
    - ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ
```java
@Embeddable
@Getter
public class Address {
    private String city;
    private String street;
    private String zipcode;
    }

    @Builder
    public Address(String city,String street,String zipcode){
        this.city=city;
        this.street=street;
        this.zipcode=zipcode;
    }
}
```
```java
@Entity
@Getter 
public class Member {
    @Id
    @GeneratedValue
    @Column(name = "member_id")
    private Long id;

    private String name;

    @Embedded
    private Address address;

}
```
## @Builderì˜ ì›ë¦¬
- íŒŒë¼ë¯¸í„° ë³€ìˆ˜ëª…ìœ¼ë¡œ ë©”ì†Œë“œ ìƒì„±
- StudentRequest > Student
```java
@Transactional
public StudentResponse createStudent(StudentRequest request) {
    Student student = Student.builder()
            .studentName(request.getStudentName())
            //.address(request.getCity(),request.getStreet(), request.getZipcode())
            .address(new Address(request.getCity(), request.getStreet(), request.getZipcode()))
            .build();

    studentRepository.save(student);

    return new StudentResponse(student);
}
```
## @Delegate
- ë””ë¯¸í„°ë¥¼ í•´ê²° í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜
- í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ì˜ í¼ë¸”ë¦­ ë©”ì†Œë“œë¥¼, í•„ë“œì— ì„ ì–¸ëœ ìœ„ì¹˜ì— ë§Œë“¤ì–´ì¤Œ
```java
public class Student {

    @Delegate
    @Embedded
    private Address address;
}
---
@Data
public class StudentResponse {

    public StudentResponse(Student student){
        this.id = student.getId();
        this.studentName = student.getStudentName();
        this.city = student.getCity();
        this.street = student.getStreet();
        this.zipcode = student.getZipcode();
        //ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë¨
        // this.city = student.getAddress.getCity();
        // this.street = student.getAddress.getStreet();
        // this.zipcode = student.getAddress.getZipcode();
    }
}
```
#  Mapper
- ì—”í‹°í‹°, request, response, ì½”ë©˜ë“œ, result, info ë“± ë³´í†µ 5ê°œ ì •ë„ ë¨
    - mapper ì´ìš©í•˜ëŠ”ê²Œ í¸í•¨
### íŠ¹ì§•
- ì»´íŒŒì¼ ì‹œì ì— ì½”ë“œë¥¼ ìƒì„±í•˜ì—¬ ëŸ°íƒ€ì„ì—ì„œ ì•ˆì •ì„±ì„ ë³´ì¥
- ë‹¤ë¥¸ ë§¤í•‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³´ë‹¤ ì†ë„ê°€ ë¹ ë¦„
- ì–´ë…¸í…Œì´ì…˜ processorë¥¼ ì´ìš©í•´ ê°ì²´ ê°„ ë§¤í•‘ì„ ìë™ìœ¼ë¡œ ì œê³µ
- ë‹¤ë§Œ, ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³´ë‹¤ ì˜ì¡´ì„± ì¶”ê°€ê°€ ë¨¼ì €ë˜ì–´ì•¼ í•¨
    - mapstructëŠ” ë¡¬ë³µì˜ ê²Œí„°, ì„¸í„°, ë¹Œë”ë¥¼ ì´ìš©í•˜ì—¬ ìƒì„±ë¨
    - ë”°ë¼ì„œ, ë¡¬ë³µë³´ë‹¤ ë¨¼ì € ì˜ì¡´ì„±ì´ ì„ ì–¸ëœ ê²½ìš° ì‹¤í–‰í•  ìˆ˜ ì—†ìŒ
### ì£¼ì˜ì 
- ìë™ìœ¼ë¡œ ë³€í™˜ì„ í•´ì£¼ê¸° ë•Œë¬¸ì— ê·œì•½ëŒ€ë¡œ ì•ˆí•˜ë©´ ì˜ëª» ìƒì„±ë¨
- ë§¤í¼ë¥¼ ìˆ˜ì •í•˜ë©´ ì¬ë¹Œë“œ í•´ì£¼ì–´ì•¼!
- ë³€í™˜ë˜ëŠ” í•„ë“œëª…ë“¤ì€ ê°ê° ë™ì¼í•˜ê²Œ ì„¤ì •í•´ì•¼

## ì‚¬ìš©ë²•
## 1. mapstruct ì˜ì¡´ì„± ì¶”ê°€
```
//lombok
annotationProcessor 'org.projectlombok:lombok-mapstruct-binding:0.2.0' // v1.18.16+ ë¶€í„°

// mapstruct
implementation 'org.mapstruct:mapstruct:1.4.2.Final'
annotationProcessor 'org.mapstruct:mapstruct-processor:1.4.2.Final'
```
## 2.  mapper ì¸í„°í˜ì´ìŠ¤ ìƒì„±
- ë©”ì†Œë“œëª…ì€ ììœ ë¡­ê²Œ 
- @Mapper(componentModel = "spring") ì–´ë…¸í…Œì´ì…˜ í•œì¤„ë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë•Œ beanìœ¼ë¡œ ë“±ë¡
```java
@Mapper(componentModel = "spring")
public interface StudentMapper {

     Student toStudent2(StudentForm studentForm);

     StudentResponse toStudentResponse2(Student student);

     Address toAddress2(StudentForm.StudentAddressForm addressForm);

     StudentResponse.StudentAddressResponse toStudentAddressResponse1(Address address);
}
```
## 3. buildí•˜ê¸°
- êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ì–´ì¤Œ
- ìˆ˜ì •í•˜ê²Œë˜ë©´ ì¬ë¹Œë“œí•´ì£¼ì–´ì•¼!

## 4. mapperë¥¼ ì ìš©í•˜ëŠ” í´ë˜ìŠ¤ 
1. @builder, @Getter ì„ ì–¸
2. request, responseí´ë˜ìŠ¤ì— Builderí´ë˜ìŠ¤ ìƒì„±
### Sample. Address > StudentAddressResponse
```java
public class Address {
    private String city;
    private String street;
    private String zipcode;
}
```
```java
public class StudentResponse {

    private Long id;
    private String studentName;
    private StudentAddressResponse address;

    @Data
    @Builder
    @AllArgsConstructor
    @NoArgsConstructor
    public static class StudentAddressResponse {
        //ì´ëŸ¬ë©´ mapperê°€ ì •ìƒì ìœ¼ë¡œ ë§¤í•‘ë˜ì§€ ì•ŠëŠ”ë‹¤!
        //ê°ê° city, street, zipcodeë¡œ ì„¤ì •í•´ì£¼ì–´ì•¼!
        private String address1;
        private String address2;
        private String address3;
    }

}
```

## ë§¤í•‘ ê·œì¹™ì„ ì§ì ‘ ì§€ì •í•˜ê¸°
- íƒ€ê²Ÿ í•„ë“œì™€ ì†ŒìŠ¤ í•„ë“œë¥¼ ë™ì¼í•˜ê²Œ ë§ì¶”ê¸° ì–´ë ¤ìš´ê²½ìš° ì‚¬ìš©
### ë§¤í¼ í´ë˜ìŠ¤ì˜ ë©”ì†Œë“œì— @Mapping ì ìš©
- @Mapping(target = "address1", source = "city")
    - cityë¡œ ë“¤ì–´ì˜¨ í•„ë“œë¥¼ address1ìœ¼ë¡œ ë§¤í•‘í•´ì¤€ë‹¤
```java
@Mapper(componentModel = "spring")
public interface StudentMapper {

    Student toStudent(StudentForm studentForm);

    StudentResponse toStudentResponse(Student student);

    Address toAddress(StudentForm.StudentAddressForm addressForm);

    @Mapping(target = "address1", source = "city")
    @Mapping(target = "address2", source = "street")
    @Mapping(target = "address3", source = "zipcode")
    StudentResponse.StudentAddressResponse toStudentAddressResponse(Address address);
}
```

## ê·¸ì™¸
- @Mappingë‚´ ì£¼ìš” ë©”ì†Œë“œ
    - ignore, target, source