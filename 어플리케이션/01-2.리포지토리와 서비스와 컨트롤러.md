# ê³„ì¸µêµ¬ì¡°ë³„ í•„ìˆ˜ê°œë…_ë¦¬í¬ì§€í† ë¦¬ì™€ ì„œë¹„ìŠ¤ì™€ ì»¨íŠ¸ë¡¤ëŸ¬

# ë¦¬í¬ì§€í† ë¦¬

### JPAë¦¬í¬ì§€í† ë¦¬ ìƒì†ë°›ê¸°
- JPAë¦¬í¬ì§€í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ Optionalë¡œ ë°›ì•„ì˜´. 
- ë°˜í™˜ê°’ì´ Optional. Optional í•˜ë‚˜ì˜ ì»¬ë ‰ì…˜ì´ë¼ ìƒê°í•˜ë©´ë¨.
- JPA ë¦¬í¬ì§€í† ë¦¬ëŠ” ì œë„¤ë¦­ í´ë˜ìŠ¤
    - ìƒì† ì‹œ íƒ€ì… ëª…ì‹œí•´ì•¼ í•¨


### ğŸŸ¨ ì˜µì…”ë„ê³¼ ì˜ˆì™¸ì²˜ë¦¬
- Optional.orElseThrow() 
#### Sample Code : ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì—ì„œ ì˜µì…”ë„ ì˜ˆì™¸ì²˜ë¦¬í•˜ê¸°
```java
public void deleteStudent(Long id){
        Student student = studentRepository.findById(id)
                .orElseThrow(() -> DomainException.notFoundRow(id));
    }
```
## ìµì…‰ì…˜

### 3-1.ëŸ°íƒ€ì„ ìµì…‰ì…˜
- í•´ë‹¹ ìµì…‰ì…˜ì´ ë°œìƒí•˜ëŠ” ê²½ìš°
    - ë°°ì—´ì— indexê°’ ë„˜ì–´ì„¤ë•Œ
    - ë„ ë°œìƒ
- => ìµì…‰ì…˜ì´ ë°œìƒí•˜ë©´ ë¡¤ë°±ë§ˆí¬ê°€ ì°í˜ > ìƒìœ„ì—ê¹Œì§€ ì „ë‹¬ë¨.

### 3-2.ì¼ë°˜ ìµì…‰ì…˜
- ì—ëŸ¬ì¡ì„ë•Œ try catchë¡œ ì¡ì•„ì•¼

## 4. ì»¤ìŠ¤í…€ ìµì…‰ì…˜

## 5. ğŸŸ¨ ì¿¼ë¦¬ ë©”ì†Œë“œ

- [ì°¸ê³ ](https://kihwan95.tistory.com/5)

- í•„ë“œëª…ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•´ì•¼
    ```
    [SubjectRepository.java]

    public interface SubjectRepository extends JpaRepository<Subject, Long> {

    Optional<Subject> findBySubjectType(SubjectType subjectType);
    }

    
    [subject.java]

    private Long id;
    private SubjectType subjectType;
    private int score;
    
    >> subjectì— subjectTypeì„ ì°¾ëŠ”ê²½ìš° ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ë³€ìˆ˜ëª…ì„ subjectì˜ í•„ë“œëª…ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•´ì•¼
    ```


# ì„œë¹„ìŠ¤

### ğŸŸ¨ í•„ë“œì£¼ì…ë³´ë‹¤ëŠ” ìƒì„±ì ì£¼ì…
```
    @Autowired StudentRepository studentRepository;    //(X)

    private final StudentRepository studentRepository; //(O)
```

## ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìƒì„±

### ë‹µë³€ìš© í•™ìƒê³„ì •(StudentResponse) ìƒì„±
```
@Transactional
public StudentResponse createStudent(StudentRequest request) {
    Student student = Student.builder()
            .name(request.getName())
            .score(request.getScore())
            .build();

    return new StudentResponse(studentRepository.save(student));
}
```

### ë‹µë³€ìš© í•™ìƒê³„ì •(StudentResponse) ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
```
@Transactional(readOnly = true)
public List<StudentResponse> getStudentList() {
    List<StudentResponse> result = new ArrayList<>();
    for (Student student : studentRepository.findAll()) {
        result.add(new StudentResponse(student));
    }

    return result;

    /*return studentRepository.findAll()
            .stream()
            .map(StudentResponse::new)
            .collect(Collectors.toList());*/
}
```
### ë‹µë³€ìš© í•™ìƒê³„ì •(StudentResponse) ì¡°íšŒ
```
@Transactional(readOnly = true)
public StudentResponse getStudent(Long id) {
    Student student = studentRepository.findById(id)
            .orElseThrow(() -> DomainException.notFoundRow(id));

    return new StudentResponse(student);
}
```

# ì»¨íŠ¸ë¡¤ëŸ¬


## ì»¨íŠ¸ë¡¤ëŸ¬ì˜ íŠ¹ì§•
1. íŒŒë¼ë¯¸í„°ì— ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì•¼
    - @RequestBody
    - @PathVariable
2. ì£¼ì†Œë¥¼ ì•Œë ¤ì¤˜ì•¼ 
    - @PatchMapping("/grade/{id}/score)
3. ì»¨íŠ¸ë¡¤ëŸ¬ ì—ë…¸í…Œì´ì…˜
    - @ResponseBody
    - @RequiredArgsConstructor
    - @RequestMapping("/student")

## RestController vs controller
1. @Controllerì˜ ì—­í• 
    - ë·°ì— í‘œì‹œë  ë°ì´í„°ê°€ ìˆëŠ” Model ê°ì²´ë¥¼ ë§Œë“¤ê³  ì˜¬ë°”ë¥¸ ë·°ë¥¼ ì„ íƒí•˜ëŠ” ì¼ì„ ë‹´ë‹¹
    - @ResponseBodyë¥¼ ì‚¬ìš©
        - HTTP Response Bodyì— ë°ì´í„°ë¥¼ ë‹´ì•„ ìš”ì²­ì„ ì™„ë£Œí•  ìˆ˜ ìˆìŒ
        - RESTful ì›¹ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì‘ë‹µì— ë§¤ìš° ìœ ìš©
        - ì™œëƒí•˜ë©´ ë·°ë¥¼ ë°˜í™˜í•˜ëŠ” ëŒ€ì‹  ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸
2. @RestController
    - @Controllerì™€ @ResponseBodyì˜ ì¡°í•©
    - RESTful ì›¹ ì„œë¹„ìŠ¤ë¥¼ ë³´ë‹¤ ì‰½ê²Œ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ Spring 4.0ì—ì„œ ì¶”ê°€
    - ë‹¨ìˆœíˆ ê°ì²´ë§Œì„ ë°˜í™˜í•˜ê³  ê°ì²´ ë°ì´í„°ëŠ” JSON ë˜ëŠ” XML í˜•ì‹ìœ¼ë¡œ HTTP ì‘ë‹µì— ë‹´ì•„ì„œ ì „ì†¡
- responsebody : ë°”ë””ì— ë°ì´í„°ë¥¼ ë°”ë¡œ ì „ë‹¬ ê°€ëŠ¥. 

## ResponseEntity
- HttpEntityë¥¼ ìƒì†ë°›ê³  ì‚¬ìš©ìì˜ ì‘ë‹µ ë°ì´í„°ê°€ í¬í•¨ëœ í´ë˜ìŠ¤ë¼ ì•„ë˜ë¥¼ í¬í•¨
    1. HttpStatus
    2. HttpHeaders
        - status ì½”ë“œ(200,400 ë“±)
    3. HttpBody
        - ì‘ë‹¶ê°’

- ìë™ìœ¼ë¡œ ê°ì²´ë¥¼ ë„£ì—ˆì„ë•Œ stateì½”ë“œ ì‘ë‹µê°’ì„ í†µì¼ëœ í˜•íƒœë¡œ ë³´ë‚´ì£¼ëŠ” 

## ëŒë‹¤ì‹ 
- stream
