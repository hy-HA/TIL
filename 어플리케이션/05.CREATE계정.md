
- íŠ¹ì • ê³¼ëª©ì— ëŒ€í•´ í•™ìƒì˜ ì ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. 
- íŠ¹ì • ê³¼ëª©ì— ëŒ€í•´ í•™ìƒì˜ ì ìˆ˜ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
- íŠ¹ì • ê³¼ëª©ì— ëŒ€í•´ í•™ìƒì˜ ì ìˆ˜ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
- íŠ¹ì • ê³¼ëª©ì— ëŒ€í•´ ì „ì²´ í•™ìƒë“¤ì˜ í‰ê·  ì ìˆ˜ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
# ì»¨íŠ¸ë¡¤ëŸ¬
```java
@ResponseBody
    @PatchMapping("/grade/{id}/score")
    @Operation(summary = "í…ŒìŠ¤íŠ¸ì˜ ì ìˆ˜ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤")
    public ResponseEntity<Void> getGrade(
            @PathVariable Long id,
            @RequestBody GradeRequest.UpdateGradeForm updateGradeForm
    ){
        gradeService.updateGrade(id, updateGradeForm);
        return ResponseEntity.status(HttpStatus.OK).build();
    }V
```
# ë„ë©”ì¸
- JPA ì—°ê´€ê´€ê³„ ë§¤í•‘
- ê° ë‹¨ê³„ì—ì„œ ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ë©”ì†Œë“œ ìƒì„±
1. ì„œë¹„ìŠ¤
- ê°ì²´ ìƒì„± ì‹œ ì‚¬ìš©í•  ìƒì„±ì
    - ì •ì  íŒ©í† ë¦¬ ë©”ì†Œë“œ
        - ì‚¬ìš©ë²•
            - ê°ì²´ë¥¼ ìƒì„± í›„ ì‚¬ìš©í•´ì•¼
            - staticìœ¼ë¡œ ì‘ì„±í•´ì•¼ ì„œë¹„ìŠ¤ì—ì„œ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
                - `Grade.of(student,subject,score)`
        - ë¹„êµ
2. ì»¨íŠ¸ë¡¤ëŸ¬
- responseê°ì²´ ìƒì„± ì‹œ Stringìœ¼ë¡œ ë°˜í™˜í•  ë•Œ ì‚¬ìš©í•  ë©”ì†Œë“œë¥¼ response í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©
```java
@Getter
@Entity
public class Grade {

    @Id @GeneratedValue
    private Long id;
    private Long score;

    @ManyToOne
    private Student student;

    @ManyToOne
    private Subject subject;

    //ì„œë¹„ìŠ¤ì—ì„œ gradeê°ì²´ ìƒì„±ì‹œ ì‚¬ìš©
    public static Grade of(Student student,Subject subject,Long score){

        Grade grade = new Grade();
        grade.student=student;
        grade.subject=subject;
        grade.score=score;
        return grade;
    }

    //response ê°ì²´ì— ì‚¬ìš©í•  ë©”ì†Œë“œ
    public String getSubjectType(){
        return this.subject.getSubjectType();
    }
    //response ê°ì²´ì— ì‚¬ìš©í•  ë©”ì†Œë“œ
    public String getStudentName(){
        return this.student.getStudentName();
    }
}
```
# DTO
### Requestê°ì²´
- í•´ë‹¹ requestì—ì„œ ë°›ì€ string ê°ì²´ë¥¼ ì´í›„ grade ê°ì²´ ìƒì„± ì‹œ í•„ìš”í•œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜ í•„ìš”
    - ì„œë¹„ìŠ¤ì—ì„œ í•™ìƒ ê°ì²´ ìƒì„±ì‹œ gradeFormì—ì„œ ë°›ì€ String subjectTypeì„ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì¡°íšŒí•  ì˜ˆì •
1. Stringì„ ë°›ì•„ì„œ SubjectTypeìœ¼ë¡œ ë°˜í™˜í•  getter ë©”ì†Œë“œ ìƒì„±

### ì£¼ì˜. 
- ì˜¤ë¥˜ subjectTypeìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œëª…ì´ stirngíƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ ëª…ê³¼ ê°™ì„ ê²½ìš° ì¸ì‹ì„ ëª»í•¨
    - @Dataì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì„ ê²ƒ ê°™ì€ë° ë™ì¼í•œ ë©”ì†Œë“œëª…ì´ ìˆìœ¼ë©´ ì¸ì‹ì„ ëª»í•˜ë‚˜? ğŸŸ¨

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
public class GradeForm {
    @NotNull(message = "ì´ë¦„ì€ í•„ìˆ˜ê°’ì…ë‹ˆë‹¤")
    private String studentName;
    @NotNull(message = "ê³¼ëª©ì€ í•„ìˆ˜ê°’ì…ë‹ˆë‹¤")
    private String subjectName;
    @NotNull(message = "ì ìˆ˜ëŠ” í•„ìˆ˜ê°’ì…ë‹ˆë‹¤")
    private Long score;

//    public String getStringSubjectType(){
//        return this.subjectType;
//    }

    //ğŸ§© SubjectTypeì€ public enumí´ë˜ìŠ¤ ì´ë¯€ë¡œ ëª¨ë“  í´ë˜ìŠ¤ì—ì„œ ì ‘ê·¼ê°€ëŠ¥
    public SubjectType getSubjectType(){
        return SubjectType.valueOf(subjectType);
    }

    >> swaggerì—ì„œ requestFormì´ ì•„ë˜ì²˜ëŸ¼ ë¨
    {
    "studentName": "string",
    "subjectType": "KOR",
    "score": 0,
    "stringSubjectType": "string"
    }
}

```
### Responseê°ì²´
- Gradeê°ì²´ë¥¼ ë°›ì•„ì„œ Responseê°ì²´ ë°˜í™˜
- ìƒì„±ìë¥¼ publicìœ¼ë¡œ ì‘ì„±í•´ì•¼ ì„œë¹„ìŠ¤ì—ì„œ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆìŒ
    - `return new GradeResponse(grade);`
```java
public class GradeResponse {

    private String studentName;
    private String subjectType;
    private Long score;

    public GradeResponse(Grade grade){
        this.studentName = grade.getStudent().getStudentName();
        this.subjectType = grade.getSubject().getSubjectType();
        this.score=grade.getScore();
    }
}
```
# ë¦¬í¬ì§€í† ë¦¬
- Student,Subjectë¦¬í¬ì§€í† ë¦¬ì— ì¿¼ë¦¬ë©”ì„œë“œ ì¶”ê°€ ğŸ§©
    - findByStudentName
        - ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì€ String studentName
    - findBySubjectType ğŸ§©
        - ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì€ SubjectType subjectType
```java
public interface SubjectRepository extends JpaRepository<Subject, Long> {
    ğŸ§©
    Optional<Subject> findBySubjectType(SubjectType subjectType);
}
```
```java
public interface StudentRepository extends JpaRepository<Student,Long> {
    Optional<Student> findByStudentName(String studentName);
}
```

# ì„œë¹„ìŠ¤
- Grade ê°ì²´ ìƒì„± ğŸ§©
    1. gradeFromì—ì„œ ê°’ì„ ë°›ì•„ì„œ Gradeê°ì²´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ í•„ìš”í•œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜
        - String studentName, Stirng subjectTypeë¥¼ ë°›ì•„ì„œ ê°ì²´ë¡œ ë°˜í™˜í•´ ì‚¬ìš© 
        - int score ë°›ì•„ì„œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
    2. ì •ì  íŒ©í† ë¦¬ ë©”ì†Œë“œ ì‚¬ìš©í•´ì„œ Grade ê°ì²´ ìƒì„±
- ì¿¼ë¦¬ ë©”ì†Œë“œ ğŸŸ¨
    - Subjectë¥¼ subjectë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì–»ì–´ì˜¬ ë•ŒëŠ”
        1. gradeFormì˜ String subjecTypeì„ ë°›ì•„ì„œ
        2. SubjectType subjectTypeìœ¼ë¡œ ë³€í™˜ì‹œí‚¤ê³ 
            - ë³€í™˜ ë©”ì†Œë“œëŠ” gradeFromì—ì„œ ìˆ˜í–‰
            - ì„œë¹„ìŠ¤ì—ì„œëŠ” SubjectTypeì„ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ í˜¸ì¶œ
            ```findBySubjectType(request.getSubjectType())```
        3. SubjectTypeìœ¼ë¡œ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì¡°íšŒí›„ Subjectë¥¼ ë°˜í™˜
- null ì²´í¬
    - studentì™€ subjectë¥¼ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì¡°íšŒí•´ ì˜¬ ë•Œ ì²´í¬
    - DomainExceptionì˜ notFoundRowë©”ì†Œë“œëŠ” string íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¡œ ì¡°íšŒê°€ëŠ¥
    ```request.getStringSubjectType()```
```java
@Service
@RequiredArgsConstructor
public class GradeService {

    private final GradeRepository gradeRepository;
    private final StudentRepository studentRepository;
    private final SubjectRepository subjectRepository;

    @Transactional
    public GradeResponse createGrade(GradeForm request){

        Student student = studentRepository.findByStudentName(request.getStudentName())
                .orElseThrow(()-> DomainException.notFoundRow(request.getStudentName()));
        Subject subject = subjectRepository.findBySubjectType(request.getSubjectType())
                .orElseThrow(()-> DomainException.notFoundRow(request.getStringSubjectType()));
        Grade grade = Grade.of(student,subject, request.getScore());
        gradeRepository.save(grade);
        return new GradeResponse(grade);

    }
}
```
```java
public class DomainException extends RuntimeException {
    public DomainException(String message) {
        super(message);
    }

    public static DomainException notFoundRow(Long id){
        return new DomainException(String.format("%s í•´ë‹¹ ROWê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",id));
    }
    public static DomainException notFoundRow(String str){
        return new DomainException(String.format("%s í•´ë‹¹ ROWê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",str));
    }
}
```

# ì—ëŸ¬ íˆìŠ¤í† ë¦¬
- ì™œ id ìë™ìƒì„± ì•ˆë˜ì§€?
- subjectStringTypeì€ ì™œ?
```java
@Getter
@Entity
public class Grade {

    @Id @GeneratedValue
    private Long id;
    private Long score;

    @ManyToOne
    private Student student;

    @ManyToOne
    private Subject subject;

    public static Grade of(Student student,Subject subject,Long score){

        Grade grade = new Grade();
        grade.student=student;
        grade.subject=subject;
        grade.score=score;
        return grade;
    }
}
```
