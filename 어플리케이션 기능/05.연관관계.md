- 학생의 평균점수 구하기
```
scoreResponse.java

@Data
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class ScoreResponse {
    private String studentName;
    private Double score;
}
```

```
student.java>>

public class Student {

    @Id @GeneratedValue
    @Column(name = "student_id")
    private Long id;

    private String name;

    @Embedded
    private Address address;

    //grade 테이블에 있는 student필드에 의해 매핑됨.(변경x, 읽기전용)
    @OneToMany(mappedBy = "student", cascade = CascadeType.ALL)
    private List<Grade> grades = new ArrayList<>();

    //...

    //grades 에서 평균점수를 구함
    public double getStudentAverageScore() {
        /*
        double sum = 0.0;
        for (Grade grade : grades) {
            sum += grade.getScore();
        }

        return sum / grades.size();
        */

        return grades.stream()
                .mapToInt(Grade::getScore)
                .average()
                .orElseThrow();
    }
```
```
studentService.java>>

@Transactional(readOnly = true)

    public ScoreResponse getStudentAverageScore(Long id) {
        Student student = studentRepository.findById(id)
                .orElseThrow(() -> DomainException.notFoundRow(id));

        return ScoreResponse.builder()
                .score(student.getStudentAverageScore())
                .studentName(student.getName())
                .build();
    }
```
```
studentController.java>>

@ResponseBody
@GetMapping("/student/{id}/average-score")
@Operation(summary = "학생 정보를 평균 점수를 조회합니다.")
public ResponseEntity<ScoreResponse> getStudentAverageScore(@PathVariable Long id) {
    ScoreResponse response = studentService.getStudentAverageScore(id);

    return ResponseEntity.ok(response);
}
```