# 웹 어플리케이션 계층 구조

- 컨트롤러, 서비스, 리포지토리, 도메인

- 컨트롤러 
    - 웹 MVC의 컨트롤러 역할

- 서비스 
    - 핵심 비즈니스 로직 구현
    - 비즈니스 도메인 객체를 통해 핵심 비즈니스 로직이 동작하도록 구현한 객체.
    - ex) 회원은 중복가입이 안된다 등
- 리포지토리 
    - 데이터베이스에 접근, 도메인 객체를 DB에 저장하고 관리
    - 인터페이스 클래스 + 구현체 클래스

- 도메인 
    - 비즈니스 도메인 객체
    - 예) 회원, 주문, 쿠폰 등 주로 데이터베이스에 저장하고 관리됨. 

# 클래스 의존관계

- 회원 서비스 
    - 회원 비즈니스 로직에 있는 회원 서비스

- 회원 리포지토리 (인터페이스)
    - 회원 저장은 인터페이스로 설계할 것. 

    - 아직 데이터 저장소가 선정되지 않아서, 우선 인터페이스로 구현 클래스를 변경할 수 있도록 설계

    - 추후 데이터 저장소 선정 후 바꿔끼우기 위해 인터페이스로 설계. 

    
- 메모리 회원리포지토리 
    - 메모리로 단순하게 저장하는 구현체
    - 데이터 저장소는 이후 RDB, NoSQL 등 다양한 저장소를 고민중인 상황으로 가정
    - 개발을 진행하기 위해서 초기 개발 단계에서는 구현체로 가벼운 메모리 기반의 데이터 저장소 사용. 

# 도메인
- domain팩토리/Member클래스
```
pubic class Member {
    private Long id;
    private String name;

    //게터,세터
}
```
# 리포지토리
- repository패키지/MemberRepository인터페이스
    - 회원 객체를 저장하는 저장소를 만들 것
    - 인터페이스 기능 작성
        - ex) 
            ```
            Member save(Member member);
            Optional<Member> findBuId(Long id);
            Optional<Member> findByName(String name);
            List<Member> findAll();
            ```

- repository패키지/MemoryMemberRepository클래스
    - 구현체
    - 인터페이스에서 implements 후 구현
    ```
    public class MemoryMemberRepository implements MemberRepository {

        private static Map<Long, Member> store = new HashMap<>();
        private static long sequence = 0L;

        @Override
        // 인터페이스 기능들 하나하나 구현
    }
    ```
# 테스트

- 클래스에서 cmd + shift + t를 누르면 자동으로 클래스 생성됨.
- 클래스 라이브러리는 JUnit5로 선택
- Member선택 후 ok

# 서비스
- 회원 리포지토리와 회원 도메인을 활용해서 비즈니스 로직을 작성.

- service패키지/Memberservice클래스
    ```
    MemberService.java>>

    public class MemberService {

    // 회원 리포지토리 객체 생성
    private final MemberRepository memberRepository = new MemoryMemberRepository();

    //회원가입 서비스
    public Long join(Member member) {

    validateDuplicateMember(member); //중복 회원 검증
    memberRepository.save(member);
    return member.getId();
    }

    private void validateDuplicateMember(Member member) {~~~}
    ```

# 컨트롤러

